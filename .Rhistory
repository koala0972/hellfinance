#sd$label = "sd"
sh$label = "和鑫"
sl$label = "群創"
sp$label = "谷崧"
sr$label = "洋華"
#sv$label = "sv"
sx$label = "sx"
sy$label = "sy"
sz$label = "sz"
s1$label = "s1"
s2$label = "s2"
s4$label = "s4"
df = rbind(tail(sb, n = days),tail(sh, n = days), tail(sl, n = days), tail(sp, n = days), tail(sr, n = days),tail(sx, n = days),tail(sy, n = days),tail(sz, n = days),tail(s1, n = days),tail(s2, n = days),tail(s4, n = days))
#df = tail(df, n = days)
# Packages
library(ggplot2)
library(directlabels)
# The plot - labels at the beginning and the ends of the lines.
#ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
#  geom_line()  +
#  scale_colour_discrete(guide = 'none')  +
#  geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
geom_line()  +
scale_colour_discrete(guide = 'none')  +
geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
}
compairlist("2409.tw", 180)
COMpanel <- function(days){
library(quantmod)
getSymbols("2409.tw")
#getSymbols("2436.tw") 成長過高
#getSymbols("2458.tw") 成長過高
getSymbols("3049.tw")
getSymbols("3481.tw")
getSymbols("3607.tw")
getSymbols("3622.tw")
#getSymbols("5471.tw") 成長過高
getSymbols("6153.tw")
getSymbols("6116.tw")
getSymbols("6243.tw")
getSymbols("6251.tw")
getSymbols("8105.tw")
sb = data.frame(`2409.TW`)
#sc = data.frame(`2436.TW`)
#sd = data.frame(`2458.TW`)
sh = data.frame(`3049.TW`)
sl = data.frame(`3481.TW`)
sp = data.frame(`3607.TW`)
sr = data.frame(`3622.TW`)
#sv = data.frame(`5471.TW`)
sx = data.frame(`6153.TW`)
sy = data.frame(`6116.TW`)
sz = data.frame(`6243.TW`)
s1 = data.frame(`6251.TW`)
s4 = data.frame(`8105.TW`)
names = gsub("^........(.*$)", "\\1", names(`2409.TW`))
names(sb) = names
#names(sc) = names
#names(sd) = names
names(sh) = names
names(sl) = names
names(sp) = names
names(sr) = names
#names(sv) = names
names(sx) = names
names(sy) = names
names(sz) = names
names(s1) = names
names(s4) = names
# rbind into one dataframe
sb$label = "友達"
#sc$label = "sc"
#sd$label = "sd"
sh$label = "和鑫"
sl$label = "群創"
sp$label = "谷崧"
sr$label = "洋華"
#sv$label = "sv"
sx$label = "sx"
sy$label = "sy"
sz$label = "sz"
s1$label = "s1"
s4$label = "s4"
df = rbind(tail(sb, n = days),tail(sh, n = days), tail(sl, n = days), tail(sp, n = days), tail(sr, n = days),tail(sx, n = days),tail(sy, n = days),tail(sz, n = days),tail(s1, n = days),tail(s4, n = days))
#df = tail(df, n = days)
# Packages
library(ggplot2)
library(directlabels)
# The plot - labels at the beginning and the ends of the lines.
#ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
#  geom_line()  +
#  scale_colour_discrete(guide = 'none')  +
#  geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
geom_line()  +
scale_colour_discrete(guide = 'none')  +
geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
}
compairlist("2409.tw", 180)
COMpanel <- function(days){
library(quantmod)
getSymbols("2409.tw")
#getSymbols("2436.tw") 成長過高
#getSymbols("2458.tw") 成長過高
getSymbols("3049.tw")
getSymbols("3481.tw")
getSymbols("3607.tw")
getSymbols("3622.tw")
#getSymbols("5471.tw") 成長過高
getSymbols("6153.tw")
getSymbols("6116.tw")
getSymbols("6243.tw")
getSymbols("8105.tw")
sb = data.frame(`2409.TW`)
#sc = data.frame(`2436.TW`)
#sd = data.frame(`2458.TW`)
sh = data.frame(`3049.TW`)
sl = data.frame(`3481.TW`)
sp = data.frame(`3607.TW`)
sr = data.frame(`3622.TW`)
#sv = data.frame(`5471.TW`)
sx = data.frame(`6153.TW`)
sy = data.frame(`6116.TW`)
sz = data.frame(`6243.TW`)
s4 = data.frame(`8105.TW`)
names = gsub("^........(.*$)", "\\1", names(`2409.TW`))
names(sb) = names
#names(sc) = names
#names(sd) = names
names(sh) = names
names(sl) = names
names(sp) = names
names(sr) = names
#names(sv) = names
names(sx) = names
names(sy) = names
names(sz) = names
names(s4) = names
# rbind into one dataframe
sb$label = "友達"
#sc$label = "sc"
#sd$label = "sd"
sh$label = "和鑫"
sl$label = "群創"
sp$label = "谷崧"
sr$label = "洋華"
#sv$label = "sv"
sx$label = "sx"
sy$label = "sy"
sz$label = "sz"
s4$label = "s4"
df = rbind(tail(sb, n = days),tail(sh, n = days), tail(sl, n = days), tail(sp, n = days), tail(sr, n = days),tail(sx, n = days),tail(sy, n = days),tail(sz, n = days),tail(s4, n = days))
#df = tail(df, n = days)
# Packages
library(ggplot2)
library(directlabels)
# The plot - labels at the beginning and the ends of the lines.
#ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
#  geom_line()  +
#  scale_colour_discrete(guide = 'none')  +
#  geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
geom_line()  +
scale_colour_discrete(guide = 'none')  +
geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
}
compairlist("2409.tw", 180)
COMpanel <- function(days){
library(quantmod)
getSymbols("2409.tw")
#getSymbols("2436.tw") 成長過高
#getSymbols("2458.tw") 成長過高
getSymbols("3049.tw")
getSymbols("3481.tw")
getSymbols("3607.tw")
getSymbols("3622.tw")
#getSymbols("5471.tw") 成長過高
getSymbols("6116.tw")
getSymbols("6243.tw")
getSymbols("8105.tw")
sb = data.frame(`2409.TW`)
#sc = data.frame(`2436.TW`)
#sd = data.frame(`2458.TW`)
sh = data.frame(`3049.TW`)
sl = data.frame(`3481.TW`)
sp = data.frame(`3607.TW`)
sr = data.frame(`3622.TW`)
#sv = data.frame(`5471.TW`)
sy = data.frame(`6116.TW`)
sz = data.frame(`6243.TW`)
s4 = data.frame(`8105.TW`)
names = gsub("^........(.*$)", "\\1", names(`2409.TW`))
names(sb) = names
#names(sc) = names
#names(sd) = names
names(sh) = names
names(sl) = names
names(sp) = names
names(sr) = names
#names(sv) = names
names(sy) = names
names(sz) = names
names(s4) = names
# rbind into one dataframe
sb$label = "友達"
#sc$label = "sc"
#sd$label = "sd"
sh$label = "和鑫"
sl$label = "群創"
sp$label = "谷崧"
sr$label = "洋華"
#sv$label = "sv"
sy$label = "sy"
sz$label = "sz"
s4$label = "s4"
df = rbind(tail(sb, n = days),tail(sh, n = days), tail(sl, n = days), tail(sp, n = days), tail(sr, n = days),tail(sy, n = days),tail(sz, n = days),tail(s4, n = days))
#df = tail(df, n = days)
# Packages
library(ggplot2)
library(directlabels)
# The plot - labels at the beginning and the ends of the lines.
#ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
#  geom_line()  +
#  scale_colour_discrete(guide = 'none')  +
#  geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
geom_line()  +
scale_colour_discrete(guide = 'none')  +
geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
}
compairlist("2409.tw", 180)
COMpanel <- function(days){
library(quantmod)
getSymbols("2409.tw")
#getSymbols("2436.tw") 成長過高
#getSymbols("2458.tw") 成長過高
#getSymbols("3049.tw") 低成長
getSymbols("3481.tw")
getSymbols("3607.tw")
getSymbols("3622.tw")
#getSymbols("5471.tw") 成長過高
getSymbols("6116.tw")
getSymbols("6243.tw")
getSymbols("8105.tw")
sb = data.frame(`2409.TW`)
#sc = data.frame(`2436.TW`)
#sd = data.frame(`2458.TW`)
#sh = data.frame(`3049.TW`)
sl = data.frame(`3481.TW`)
sp = data.frame(`3607.TW`)
sr = data.frame(`3622.TW`)
#sv = data.frame(`5471.TW`)
sy = data.frame(`6116.TW`)
sz = data.frame(`6243.TW`)
s4 = data.frame(`8105.TW`)
names = gsub("^........(.*$)", "\\1", names(`2409.TW`))
names(sb) = names
#names(sc) = names
#names(sd) = names
#names(sh) = names
names(sl) = names
names(sp) = names
names(sr) = names
#names(sv) = names
names(sy) = names
names(sz) = names
names(s4) = names
# rbind into one dataframe
sb$label = "友達"
#sc$label = "sc"
#sd$label = "sd"
#sh$label = "和鑫"
sl$label = "群創"
sp$label = "谷崧"
sr$label = "洋華"
#sv$label = "sv"
sy$label = "sy"
sz$label = "sz"
s4$label = "s4"
df = rbind(tail(sb, n = days), tail(sl, n = days), tail(sp, n = days), tail(sr, n = days),tail(sy, n = days),tail(sz, n = days),tail(s4, n = days))
#df = tail(df, n = days)
# Packages
library(ggplot2)
library(directlabels)
# The plot - labels at the beginning and the ends of the lines.
#ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
#  geom_line()  +
#  scale_colour_discrete(guide = 'none')  +
#  geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
geom_line()  +
scale_colour_discrete(guide = 'none')  +
geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
}
compairlist("2409.tw", 180)
COMpanel <- function(days){
library(quantmod)
getSymbols("2409.tw")
#getSymbols("2436.tw") 成長過高
#getSymbols("2458.tw") 成長過高
#getSymbols("3049.tw") 低成長
getSymbols("3481.tw")
getSymbols("3607.tw")
#getSymbols("3622.tw") 大量級
#getSymbols("5471.tw") 成長過高
getSymbols("6116.tw")
getSymbols("6243.tw")
getSymbols("8105.tw")
sb = data.frame(`2409.TW`)
#sc = data.frame(`2436.TW`)
#sd = data.frame(`2458.TW`)
#sh = data.frame(`3049.TW`)
sl = data.frame(`3481.TW`)
sp = data.frame(`3607.TW`)
#sr = data.frame(`3622.TW`)
#sv = data.frame(`5471.TW`)
sy = data.frame(`6116.TW`)
sz = data.frame(`6243.TW`)
s4 = data.frame(`8105.TW`)
names = gsub("^........(.*$)", "\\1", names(`2409.TW`))
names(sb) = names
#names(sc) = names
#names(sd) = names
#names(sh) = names
names(sl) = names
names(sp) = names
#names(sr) = names
#names(sv) = names
names(sy) = names
names(sz) = names
names(s4) = names
# rbind into one dataframe
sb$label = "友達"
#sc$label = "sc"
#sd$label = "sd"
#sh$label = "和鑫"
sl$label = "群創"
sp$label = "谷崧"
#sr$label = "洋華"
#sv$label = "sv"
sy$label = "sy"
sz$label = "sz"
s4$label = "s4"
df = rbind(tail(sb, n = days), tail(sl, n = days), tail(sp, n = days),tail(sy, n = days),tail(sz, n = days),tail(s4, n = days))
#df = tail(df, n = days)
# Packages
library(ggplot2)
library(directlabels)
# The plot - labels at the beginning and the ends of the lines.
#ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
#  geom_line()  +
#  scale_colour_discrete(guide = 'none')  +
#  geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
geom_line()  +
scale_colour_discrete(guide = 'none')  +
geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
}
compairlist("2409.tw", 180)
COMpanel <- function(days){
library(quantmod)
getSymbols("2409.tw")
#getSymbols("2436.tw") 成長過高
#getSymbols("2458.tw") 成長過高
#getSymbols("3049.tw") 低成長
getSymbols("3481.tw")
getSymbols("3607.tw")
#getSymbols("3622.tw") 大量級
#getSymbols("5471.tw") 成長過高
getSymbols("6116.tw")
getSymbols("6243.tw")
sb = data.frame(`2409.TW`)
#sc = data.frame(`2436.TW`)
#sd = data.frame(`2458.TW`)
#sh = data.frame(`3049.TW`)
sl = data.frame(`3481.TW`)
sp = data.frame(`3607.TW`)
#sr = data.frame(`3622.TW`)
#sv = data.frame(`5471.TW`)
sy = data.frame(`6116.TW`)
sz = data.frame(`6243.TW`)
names = gsub("^........(.*$)", "\\1", names(`2409.TW`))
names(sb) = names
#names(sc) = names
#names(sd) = names
#names(sh) = names
names(sl) = names
names(sp) = names
#names(sr) = names
#names(sv) = names
names(sy) = names
names(sz) = names
# rbind into one dataframe
sb$label = "友達"
#sc$label = "sc"
#sd$label = "sd"
#sh$label = "和鑫"
sl$label = "群創"
sp$label = "谷崧"
#sr$label = "洋華"
#sv$label = "sv"
sy$label = "sy"
sz$label = "sz"
df = rbind(tail(sb, n = days), tail(sl, n = days), tail(sp, n = days),tail(sy, n = days),tail(sz, n = days))
#df = tail(df, n = days)
# Packages
library(ggplot2)
library(directlabels)
# The plot - labels at the beginning and the ends of the lines.
#ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
#  geom_line()  +
#  scale_colour_discrete(guide = 'none')  +
#  geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
geom_line()  +
scale_colour_discrete(guide = 'none')  +
geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
}
compairlist("2409.tw", 180)
COMpanel <- function(days){
library(quantmod)
getSymbols("2409.tw")
#getSymbols("2436.tw") 成長過高
#getSymbols("2458.tw") 成長過高
#getSymbols("3049.tw") 低成長
getSymbols("3481.tw")
getSymbols("3607.tw")
#getSymbols("3622.tw") 大量級
#getSymbols("5471.tw") 成長過高
getSymbols("6116.tw")
getSymbols("6243.tw")
sb = data.frame(`2409.TW`)
#sc = data.frame(`2436.TW`)
#sd = data.frame(`2458.TW`)
#sh = data.frame(`3049.TW`)
sl = data.frame(`3481.TW`)
#sr = data.frame(`3622.TW`)
#sv = data.frame(`5471.TW`)
sy = data.frame(`6116.TW`)
names = gsub("^........(.*$)", "\\1", names(`2409.TW`))
names(sb) = names
#names(sc) = names
#names(sd) = names
#names(sh) = names
names(sl) = names
#names(sr) = names
#names(sv) = names
names(sy) = names
# rbind into one dataframe
sb$label = "友達"
#sc$label = "sc"
#sd$label = "sd"
#sh$label = "和鑫"
sl$label = "群創"
#sr$label = "洋華"
#sv$label = "sv"
sy$label = "彩晶"
df = rbind(tail(sb, n = days), tail(sl, n = days), tail(sy, n = days))
#df = tail(df, n = days)
# Packages
library(ggplot2)
library(directlabels)
# The plot - labels at the beginning and the ends of the lines.
#ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
#  geom_line()  +
#  scale_colour_discrete(guide = 'none')  +
#  geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
ggplot(df, aes(as.Date(rownames(df)), Adjusted, group = label, colour = label)) +
geom_line()  +
scale_colour_discrete(guide = 'none')  +
geom_dl(aes(label = label), method = list(dl.combine("first.points", "last.points")))
}
compairlist("2409.tw", 180)
library(tidyverse)
library(tidyquant)
library(lubridate)
HU <- getSymbols("^TWII", auto.assign = FALSE, from = "2017-01-01")
HU <- HU[(rowSums(is.na(HU)) == 0), ]
HU <- tail(HU, n = 75)
HU <- round(HU, digits = 2)
HU <- as.data.frame(HU)
HU <- cbind(date = rownames(HU), HU)
names = gsub("^.....(.*$)", "\\1", names(HU))#點數等於字數
names(HU) <- tolower(names)
rownames(HU) <- 1:nrow(HU)
HU <- cbind(symbol = "GG", HU)
HU$date <- as.Date(HU$date, format =  "%Y-%m-%d")
HU <- as.tibble(HU)
FANG_macd <- HU %>%
group_by(symbol) %>%
tq_mutate(select     = close,
mutate_fun = MACD,
nFast      = 12,
nSlow      = 26,
nSig       = 9,
maType     = SMA) %>%
mutate(diff = macd - signal) %>%
select(-(open:volume))
FANG_macd
FANG_macd %>%
filter(date >= as_date("2021-01-01")) %>%
ggplot(aes(x = date)) +
geom_hline(yintercept = 0, color = palette_light()[[1]]) +
geom_line(aes(y = macd, col = symbol)) +
geom_line(aes(y = signal), color = "blue", linetype = 2) +
geom_bar(aes(y = diff), stat = "identity", color = palette_light()[[1]]) +
facet_wrap(~ symbol, ncol = 2, scale = "free_y") +
labs(title = "Moving Average Convergence Divergence",
y = "MACD", x = "", color = "") +
theme_tq() +
scale_color_tq()
